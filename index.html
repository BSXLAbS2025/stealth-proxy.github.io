<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Secure Browser</title>
    <style>
        body { font-family: Arial; max-width: 1000px; margin: 0 auto; padding: 20px; background: #f0f0f0; }
        .container { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
        .header { text-align: center; margin-bottom: 20px; }
        .url-section { display: flex; gap: 10px; margin-bottom: 20px; }
        #urlInput { flex: 1; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; }
        #fetchBtn { padding: 12px 25px; background: #28a745; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; }
        #fetchBtn:hover { background: #218838; }
        #fetchBtn:disabled { background: #6c757d; cursor: not-allowed; }
        .result-section { margin-top: 20px; }
        #result { border: 2px solid #e9ecef; padding: 20px; border-radius: 8px; min-height: 500px; background: #f8f9fa; }
        .status { padding: 12px; margin: 15px 0; border-radius: 8px; font-weight: bold; }
        .success { background: #d1edff; color: #004085; border: 1px solid #b8daff; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        .hidden { display: none; }
        .examples { background: #fff3cd; padding: 15px; border-radius: 8px; margin: 15px 0; }
        .example-btn { background: #ffc107; border: none; padding: 8px 15px; margin: 5px; border-radius: 5px; cursor: pointer; }
        .example-btn:hover { background: #e0a800; }
        .tab { overflow: hidden; border: 1px solid #ccc; background: #f1f1f1; border-radius: 8px 8px 0 0; }
        .tab button { background: inherit; float: left; border: none; outline: none; cursor: pointer; padding: 14px 16px; transition: 0.3s; }
        .tab button:hover { background: #ddd; }
        .tab button.active { background: #007bff; color: white; }
        .tabcontent { display: none; padding: 20px; border: 1px solid #ccc; border-top: none; border-radius: 0 0 8px 8px; }
        textarea { width: 100%; height: 300px; font-family: monospace; padding: 10px; border: 1px solid #ddd; border-radius: 5px; }
        iframe { width: 100%; height: 500px; border: 1px solid #ddd; border-radius: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåê Secure Web Browser</h1>
            <p>–î–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É —á–µ—Ä–µ–∑ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –º–µ—Ç–æ–¥—ã</p>
        </div>

        <div class="status info">
            üí° <strong>–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</strong> –í–≤–µ–¥–∏—Ç–µ URL —Å–∞–π—Ç–∞ –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–º–µ—Ä –Ω–∏–∂–µ
        </div>

        <div class="url-section">
            <input type="url" id="urlInput" placeholder="https://example.com" value="https://httpbin.org/ip">
            <button id="fetchBtn">–ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
        </div>

        <div class="examples">
            <strong>–ü—Ä–∏–º–µ—Ä—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:</strong><br>
            <button class="example-btn" data-url="https://httpbin.org/ip">IP –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</button>
            <button class="example-btn" data-url="https://api.github.com">GitHub API</button>
            <button class="example-btn" data-url="https://jsonplaceholder.typicode.com/posts/1">JSON —Ç–µ—Å—Ç</button>
            <button class="example-btn" data-url="https://news.ycombinator.com">Hacker News</button>
            <button class="example-btn" data-url="https://textise.net">Textise (–æ–±—Ö–æ–¥ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫)</button>
        </div>

        <div class="tab">
            <button class="tablinks active" onclick="openTab(event, 'Preview')">–ü—Ä–æ—Å–º–æ—Ç—Ä</button>
            <button class="tablinks" onclick="openTab(event, 'HTML')">HTML –∫–æ–¥</button>
            <button class="tablinks" onclick="openTab(event, 'Text')">–¢–µ–∫—Å—Ç</button>
            <button class="tablinks" onclick="openTab(event, 'JSON')">JSON</button>
        </div>

        <div class="result-section">
            <div id="result">
                <div style="text-align: center; padding: 50px;">
                    <h3>üëÜ –í–≤–µ–¥–∏—Ç–µ URL –≤—ã—à–µ</h3>
                    <p>–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å</p>
                </div>
            </div>
        </div>

        <div class="status info" style="margin-top: 20px;">
            üîí <strong>–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:</strong> –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ –≤–∞—à –±—Ä–∞—É–∑–µ—Ä. 
            –ú—ã –Ω–µ —Ö—Ä–∞–Ω–∏–º –∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–µ–º –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ.
        </div>
    </div>

    <script>
        class StealthBrowser {
            constructor() {
                this.currentMethod = 'iframe';
                this.retryCount = 0;
                this.maxRetries = 2;
            }

            showStatus(message, type = 'info') {
                // –°–æ–∑–¥–∞–µ–º –∏–ª–∏ –Ω–∞—Ö–æ–¥–∏–º —ç–ª–µ–º–µ–Ω—Ç —Å—Ç–∞—Ç—É—Å–∞
                let statusEl = document.getElementById('status');
                if (!statusEl) {
                    statusEl = document.createElement('div');
                    statusEl.id = 'status';
                    document.querySelector('.header').after(statusEl);
                }
                
                statusEl.textContent = message;
                statusEl.className = `status ${type}`;
                statusEl.classList.remove('hidden');
                
                setTimeout(() => {
                    statusEl.classList.add('hidden');
                }, 5000);
            }

            // –ú–µ—Ç–æ–¥ 1: Iframe –¥–ª—è HTML –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            loadInIframe(url) {
                return new Promise((resolve, reject) => {
                    const resultDiv = document.getElementById('result');
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º iframe
                    resultDiv.innerHTML = `
                        <div class="status info">
                            üìÑ –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º —Ä–µ–∂–∏–º–µ...
                        </div>
                        <iframe src="${url}" id="contentFrame"></iframe>
                        <div style="margin-top: 10px;">
                            <button onclick="switchToText()" class="example-btn">–ü–æ–∫–∞–∑–∞—Ç—å –∫–∞–∫ —Ç–µ–∫—Å—Ç</button>
                        </div>
                    `;
                    
                    resolve({ type: 'iframe', url: url });
                });
            }

            // –ú–µ—Ç–æ–¥ 2: Fetch —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–∏—Å—ã Google Apps Script
            async fetchViaGoogleAppsScript(url) {
                try {
                    // –≠—Ç–æ –ø—Ä–∏–º–µ—Ä - –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ–π Google Apps Script
                    const scriptUrls = [
                        'https://script.google.com/macros/s/AKfycbzEXAMPLE/exec',
                        'https://script.google.com/macros/s/AKfycbzEXAMPLE2/exec'
                    ];
                    
                    for (let scriptUrl of scriptUrls) {
                        try {
                            const response = await fetch(`${scriptUrl}?url=${encodeURIComponent(url)}`);
                            if (response.ok) {
                                const data = await response.text();
                                return { type: 'text', data: data };
                            }
                        } catch (e) {
                            console.log('Google Apps Script failed:', e);
                        }
                    }
                    throw new Error('Google Apps Script –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω');
                } catch (error) {
                    throw error;
                }
            }

            // –ú–µ—Ç–æ–¥ 3: JSONP –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
            fetchViaJSONP(url) {
                return new Promise((resolve, reject) => {
                    if (!url.includes('json')) {
                        reject(new Error('JSONP —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å JSON API'));
                        return;
                    }

                    const callbackName = 'jsonp_callback_' + Date.now();
                    const script = document.createElement('script');
                    
                    window[callbackName] = function(data) {
                        delete window[callbackName];
                        document.body.removeChild(script);
                        resolve({ type: 'json', data: data });
                    };

                    script.src = url + (url.includes('?') ? '&' : '?') + 'callback=' + callbackName;
                    document.body.appendChild(script);
                    
                    setTimeout(() => {
                        if (window[callbackName]) {
                            delete window[callbackName];
                            document.body.removeChild(script);
                            reject(new Error('JSONP timeout'));
                        }
                    }, 10000);
                });
            }

            // –ú–µ—Ç–æ–¥ 4: Form submission –¥–ª—è POST –∑–∞–ø—Ä–æ—Å–æ–≤
            fetchViaForm(url, method = 'GET') {
                return new Promise((resolve) => {
                    const form = document.createElement('form');
                    form.method = method;
                    form.action = url;
                    form.target = 'formTarget';
                    
                    const iframe = document.createElement('iframe');
                    iframe.name = 'formTarget';
                    iframe.style.display = 'none';
                    
                    document.body.appendChild(iframe);
                    document.body.appendChild(form);
                    
                    // –î–ª—è GET –ø—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º
                    if (method === 'GET') {
                        form.submit();
                    }
                    
                    // –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ iframe
                    iframe.onload = function() {
                        try {
                            const content = iframe.contentDocument.body.innerHTML;
                            resolve({ type: 'html', data: content });
                        } catch (e) {
                            resolve({ type: 'html', data: 'Content loaded' });
                        }
                    };
                    
                    setTimeout(() => {
                        resolve({ type: 'html', data: 'Form submitted' });
                    }, 5000);
                });
            }

            // –û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –∑–∞–≥—Ä—É–∑–∫–∏
            async loadUrl(url) {
                this.showStatus('üîÑ –ù–∞—á–∏–Ω–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É...', 'info');
                
                try {
                    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ URL
                    if (url.includes('.json') || url.includes('/api/')) {
                        // JSON –¥–∞–Ω–Ω—ã–µ
                        try {
                            return await this.fetchViaJSONP(url);
                        } catch (e) {
                            return await this.loadInIframe(url);
                        }
                    } else if (url.includes('httpbin.org') || url.includes('github.com')) {
                        // API endpoints
                        try {
                            return await this.fetchViaJSONP(url);
                        } catch (e) {
                            return await this.loadInIframe(url);
                        }
                    } else {
                        // HTML —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                        return await this.loadInIframe(url);
                    }
                } catch (error) {
                    this.retryCount++;
                    if (this.retryCount <= this.maxRetries) {
                        this.showStatus(`üîÑ –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ ${this.retryCount}/${this.maxRetries}...`, 'info');
                        return await this.loadUrl(url);
                    } else {
                        throw error;
                    }
                }
            }

            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
            displayResult(result, url) {
                const resultDiv = document.getElementById('result');
                
                switch (result.type) {
                    case 'iframe':
                        resultDiv.innerHTML = `
                            <div class="status success">
                                ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º —Ä–µ–∂–∏–º–µ
                            </div>
                            <iframe src="${url}" id="contentFrame"></iframe>
                            <div style="margin-top: 10px;">
                                <button onclick="showPageSource('${url}')" class="example-btn">
                                    –ü–æ–∫–∞–∑–∞—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
                                </button>
                                <button onclick="switchToTextMode('${url}')" class="example-btn">
                                    –¢–µ–∫—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
                                </button>
                            </div>
                        `;
                        break;
                        
                    case 'json':
                        resultDiv.innerHTML = `
                            <div class="status success">
                                ‚úÖ JSON –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã
                            </div>
                            <h4>–î–∞–Ω–Ω—ã–µ –æ—Ç ${url}:</h4>
                            <pre><code>${JSON.stringify(result.data, null, 2)}</code></pre>
                        `;
                        break;
                        
                    case 'text':
                        resultDiv.innerHTML = `
                            <div class="status success">
                                ‚úÖ –¢–µ–∫—Å—Ç –ø–æ–ª—É—á–µ–Ω
                            </div>
                            <h4>–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:</h4>
                            <textarea readonly>${result.data}</textarea>
                        `;
                        break;
                        
                    case 'html':
                        resultDiv.innerHTML = `
                            <div class="status success">
                                ‚úÖ HTML –ø–æ–ª—É—á–µ–Ω
                            </div>
                            <h4>–ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥:</h4>
                            <textarea readonly>${result.data}</textarea>
                        `;
                        break;
                }
                
                this.retryCount = 0;
            }
        }

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫
        function showPageSource(url) {
            fetch(url)
                .then(response => response.text())
                .then(html => {
                    document.getElementById('result').innerHTML = `
                        <div class="status info">
                            üìù –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
                        </div>
                        <textarea readonly>${html}</textarea>
                    `;
                })
                .catch(error => {
                    document.getElementById('result').innerHTML = `
                        <div class="status error">
                            ‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞: ${error.message}
                        </div>
                    `;
                });
        }

        function switchToTextMode(url) {
            fetch(url)
                .then(response => response.text())
                .then(text => {
                    // –£–¥–∞–ª—è–µ–º —Ç–µ–≥–∏ –¥–ª—è —á–∏—Å—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
                    const cleanText = text.replace(/<[^>]*>/g, '');
                    document.getElementById('result').innerHTML = `
                        <div class="status info">
                            üìÑ –¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ
                        </div>
                        <textarea readonly>${cleanText}</textarea>
                    `;
                })
                .catch(error => {
                    document.getElementById('result').innerHTML = `
                        <div class="status error">
                            ‚ùå –û—à–∏–±–∫–∞: ${error.message}
                        </div>
                    `;
                });
        }

        function openTab(evt, tabName) {
            const tabcontent = document.getElementsByClassName("tabcontent");
            for (let i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            
            const tablinks = document.getElementsByClassName("tablinks");
            for (let i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            const browser = new StealthBrowser();
            const fetchBtn = document.getElementById('fetchBtn');
            const urlInput = document.getElementById('urlInput');

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–Ω–æ–ø–∫–∏
            fetchBtn.addEventListener('click', async function() {
                const url = urlInput.value.trim();
                
                if (!url) {
                    browser.showStatus('‚ùå –í–≤–µ–¥–∏—Ç–µ URL', 'error');
                    return;
                }

                if (!url.startsWith('http')) {
                    browser.showStatus('‚ùå URL –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å http:// –∏–ª–∏ https://', 'error');
                    return;
                }

                try {
                    fetchBtn.disabled = true;
                    fetchBtn.textContent = '–ó–∞–≥—Ä—É–∑–∫–∞...';
                    
                    browser.showStatus('üîÑ –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ...', 'info');
                    
                    const result = await browser.loadUrl(url);
                    browser.displayResult(result, url);
                    
                    browser.showStatus('‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!', 'success');
                    
                } catch (error) {
                    console.error('Error:', error);
                    document.getElementById('result').innerHTML = `
                        <div class="status error">
                            ‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}
                        </div>
                        <div style="margin-top: 20px;">
                            <h4>–ß—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:</h4>
                            <ul>
                                <li>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å URL</li>
                                <li>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π —Å–∞–π—Ç</li>
                                <li>–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Å–∞–π—Ç –¥–æ—Å—Ç—É–ø–µ–Ω</li>
                                <li>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É</li>
                            </ul>
                        </div>
                    `;
                    browser.showStatus('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏', 'error');
                } finally {
                    fetchBtn.disabled = false;
                    fetchBtn.textContent = '–ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ';
                }
            });

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø—Ä–∏–º–µ—Ä–æ–≤
            document.querySelectorAll('.example-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const url = this.getAttribute('data-url');
                    urlInput.value = url;
                    fetchBtn.click();
                });
            });

            // Enter –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
            urlInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    fetchBtn.click();
                }
            });

            // –°–æ–∑–¥–∞–µ–º tab content
            const resultDiv = document.getElementById('result');
            const tabs = ['Preview', 'HTML', 'Text', 'JSON'];
            
            tabs.forEach(tab => {
                const tabContent = document.createElement('div');
                tabContent.id = tab;
                tabContent.className = 'tabcontent';
                tabContent.style.display = tab === 'Preview' ? 'block' : 'none';
                tabContent.innerHTML = '<p>–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –±—É–¥–µ—Ç –∑–¥–µ—Å—å</p>';
                resultDiv.appendChild(tabContent);
            });
        });
    </script>
</body>
</html>
